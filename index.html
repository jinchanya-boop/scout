<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Prompt', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 50%, #ddd6fe 100%); }
        .card-shadow { box-shadow: 0 4px 20px rgba(139, 92, 246, 0.1); }
        .btn-primary { background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); transition: all 0.3s ease; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3); }
        .signature-pad { border: 2px dashed #c4b5fd; background: #faf5ff; }
        .rubric-item { background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); }
        .modal-overlay { background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px); }
        .file-input-label { cursor: pointer; background-color: #f3e8ff; border: 2px dashed #c4b5fd; }
        .file-input-label:hover { background-color: #e9d5ff; }
        .image-preview { width: 100%; height: 150px; object-fit: cover; border: 1px solid #ddd6fe; }

        @media print {
            body * { visibility: hidden; }
            #printArea, #printArea * { visibility: visible; }
            #printArea { position: absolute; left: 0; top: 0; width: 100%; }
            .print-no-break { page-break-inside: avoid; }
            .print-page-break { page-break-after: always; }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <header class="bg-white/90 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <img src="https://img2.pic.in.th/pic/sa1.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤" class="w-12 h-12 rounded-full object-cover">
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤</h1>
                        <p class="text-sm text-purple-600"> ‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ ‡∏°.1-‡∏°.3</p>
                    </div>
                </div>
                <select id="gradeSelect" class="px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                    <option value="m1">‡∏°.1 - ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß</option>
                    <option value="m2">‡∏°.2 - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ</option>
                    <option value="m3">‡∏°.3 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥</option>
                </select>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8">
            <button onclick="openStudentManagement()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-purple-50 transition-colors"><div class="flex items-center space-x-3"><span class="text-2xl">üë•</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3><p class="text-sm text-gray-600">‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏•‡∏ö ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</p></div></div></button>
            <button onclick="openAttendanceCheck()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-purple-50 transition-colors"><div class="flex items-center space-x-3"><span class="text-2xl">‚úÖ</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3><p class="text-sm text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</p></div></div></button>
            <button onclick="openActivityStatusDashboard()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-indigo-50 transition-colors"><div class="flex items-center space-x-3"><span class="text-2xl">üìë</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3><p class="text-sm text-gray-600">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå</p></div></div></button>
            <button onclick="openDashboard()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-blue-50 transition-colors"><div class="flex items-center space-x-3"><span class="text-2xl">üìà</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h3><p class="text-sm text-gray-600">‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</p></div></div></button>
            <button onclick="showActivityReport()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-green-50 transition-colors"><div class="flex items-center space-x-3"><span class="text-2xl">üìä</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3><p class="text-sm text-gray-600">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p></div></div></button>
            <button onclick="showAttendanceReport()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-yellow-50 transition-colors"><div class="flex items-center space-x-3"><span class="text-2xl">üìã</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</h3><p class="text-sm text-gray-600">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</p></div></div></button>
        </div>
        <div class="bg-white/90 backdrop-blur-md rounded-2xl card-shadow p-6 mb-8">
            <div class="flex items-center mb-6"><span class="text-2xl mr-3">üìÖ</span><h2 class="text-2xl font-bold text-gray-800">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ Block Course</h2></div>
            <div id="scheduleTable" class="overflow-x-auto"></div>
        </div>
    </main>

    <div id="studentManagementModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b"><div class="flex items-center justify-between"><div class="flex items-center space-x-3"><span class="text-2xl">üë•</span><h3 class="text-xl font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3></div><button onclick="closeStudentManagement()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button></div></div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div><label class="block text-sm font-medium mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label><select id="manageGrade" onchange="loadManageStudentList()" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option><option value="‡∏°.1">‡∏°.1</option><option value="‡∏°.2">‡∏°.2</option><option value="‡∏°.3">‡∏°.3</option></select></div>
                    <div><label class="block text-sm font-medium mb-2">‡∏Å‡∏≠‡∏á</label><select id="manageGroup" onchange="updateManageTroopOptions()" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option><option value="‡∏Å‡∏≠‡∏á1">‡∏Å‡∏≠‡∏á 1</option><option value="‡∏Å‡∏≠‡∏á2">‡∏Å‡∏≠‡∏á 2</option><option value="‡∏Å‡∏≠‡∏á3">‡∏Å‡∏≠‡∏á 3</option><option value="‡∏Å‡∏≠‡∏á4">‡∏Å‡∏≠‡∏á 4</option></select></div>
                    <div><label class="block text-sm font-medium mb-2">‡∏´‡∏°‡∏π‡πà</label><select id="manageTroop" onchange="loadManageStudentList()" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option></select></div>
                    <div class="flex items-end"><button onclick="showAddStudentForm()" class="w-full px-4 py-2 btn-primary text-white rounded-lg font-medium">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button></div>
                </div>
                <div id="studentForm" class="hidden mb-6 p-4 bg-purple-50 rounded-lg"><h4 class="font-medium mb-4" id="formTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà</h4><form id="addStudentForm"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label class="block text-sm font-medium mb-1">‡∏ä‡∏∑‡πà‡∏≠</label><input type="text" id="studentFirstName" required class="w-full px-3 py-2 rounded-lg border" placeholder="‡∏ä‡∏∑‡πà‡∏≠"></div><div><label class="block text-sm font-medium mb-1">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input type="text" id="studentLastName" required class="w-full px-3 py-2 rounded-lg border" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"></div><div><label class="block text-sm font-medium mb-1">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label><input type="text" id="studentId" required class="w-full px-3 py-2 rounded-lg border" placeholder="‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß"></div></div><div class="flex justify-end space-x-3 mt-4"><button type="button" onclick="hideStudentForm()" class="px-4 py-2 border rounded-lg">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" class="px-4 py-2 btn-primary text-white rounded-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div></form></div>
                <div id="manageStudentList"><div class="text-center text-gray-500 py-8"><span class="text-4xl block mb-2">üë•</span><p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô, ‡∏Å‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p></div></div>
            </div>
        </div>
    </div>
    
    <div id="attendanceModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b"><div class="flex items-center justify-between"><div class="flex items-center space-x-3"><span class="text-2xl">‚úÖ</span><h3 class="text-xl font-bold">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3></div><button onclick="closeAttendanceCheck()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button></div></div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"><div><label class="block text-sm font-medium mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label><input type="date" id="attendanceDate" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"></div><div><label class="block text-sm font-medium mb-2">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label><select id="attendanceActivity" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</option><option value="‡πÄ‡∏ä‡πâ‡∏≤">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏ä‡πâ‡∏≤</option><option value="‡∏™‡∏≤‡∏¢">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≤‡∏¢</option><option value="‡∏ö‡πà‡∏≤‡∏¢">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ö‡πà‡∏≤‡∏¢</option></select></div></div>
                <div class="mb-6"><label class="block text-sm font-medium mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label><select id="attendanceGrade" onchange="loadAttendanceStudentList()" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option><option value="‡∏°.1">‡∏°.1</option><option value="‡∏°.2">‡∏°.2</option><option value="‡∏°.3">‡∏°.3</option></select></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"><div><label class="block text-sm font-medium mb-2">‡∏Å‡∏≠‡∏á</label><select id="attendanceGroup" onchange="updateAttendanceTroopOptions()" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option><option value="‡∏Å‡∏≠‡∏á1">‡∏Å‡∏≠‡∏á 1</option><option value="‡∏Å‡∏≠‡∏á2">‡∏Å‡∏≠‡∏á 2</option><option value="‡∏Å‡∏≠‡∏á3">‡∏Å‡∏≠‡∏á 3</option><option value="‡∏Å‡∏≠‡∏á4">‡∏Å‡∏≠‡∏á 4</option></select></div><div><label class="block text-sm font-medium mb-2">‡∏´‡∏°‡∏π‡πà</label><select id="attendanceTroop" onchange="loadAttendanceStudentList()" class="w-full px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option></select></div></div>
                <div id="attendanceStudentList"><div class="text-center text-gray-500 py-8"><span class="text-4xl block mb-2">‚úÖ</span><p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</p></div></div>
                <div class="flex justify-end mt-6"><button onclick="saveAttendance()" class="px-6 py-2 btn-primary text-white rounded-lg font-medium">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button></div>
            </div>
        </div>
    </div>

    <div id="activityModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b"><div class="flex items-center justify-between"><div class="flex items-center space-x-3"><span class="text-2xl">üìù</span><h3 class="text-xl font-bold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3></div><button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button></div></div>
            <div class="p-6">
                <form id="activityForm">
                    <div class="mb-6"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium mb-2">üïê ‡πÄ‡∏ß‡∏•‡∏≤</label><input type="text" id="activityTime" class="w-full px-4 py-2 rounded-lg border" readonly></div><div><label class="block text-sm font-medium mb-2">üìã ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label><input type="text" id="activityName" class="w-full px-4 py-2 rounded-lg border" readonly></div></div></div>
                    <div class="mb-6"><label class="block text-sm font-medium mb-2">üë• ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô, ‡∏Å‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà</label><div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"><div><label class="block text-xs mb-1">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label><select id="activityGrade" onchange="loadStudentList()" class="w-full px-3 py-2 rounded-lg border"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</option><option value="‡∏°.1">‡∏°.1</option><option value="‡∏°.2">‡∏°.2</option><option value="‡∏°.3">‡∏°.3</option></select></div><div><label class="block text-xs mb-1">‡∏Å‡∏≠‡∏á</label><select id="selectedGroup" onchange="updateActivityTroopOptions()" class="w-full px-3 py-2 rounded-lg border"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option><option value="‡∏Å‡∏≠‡∏á1">‡∏Å‡∏≠‡∏á 1</option><option value="‡∏Å‡∏≠‡∏á2">‡∏Å‡∏≠‡∏á 2</option><option value="‡∏Å‡∏≠‡∏á3">‡∏Å‡∏≠‡∏á 3</option><option value="‡∏Å‡∏≠‡∏á4">‡∏Å‡∏≠‡∏á 4</option></select></div><div><label class="block text-xs mb-1">‡∏´‡∏°‡∏π‡πà</label><select id="selectedTroop" onchange="loadStudentList()" class="w-full px-3 py-2 rounded-lg border" disabled><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option></select></div></div><div id="studentAttendanceList" class="hidden"><div class="bg-purple-50 rounded-lg p-4"><h4 class="font-medium mb-3 flex items-center"><span class="mr-2">üìã</span>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô - ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</h4><div id="studentCheckList" class="space-y-2"></div></div></div></div>
                    <div id="attendanceSummary" class="mt-4 p-4 bg-gray-100 rounded-lg hidden"><h5 class="font-semibold mb-2">‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠:</h5><div class="flex flex-wrap gap-x-6 gap-y-2 text-sm"><span class="font-medium">‚úÖ ‡∏°‡∏≤: <span id="summaryPresent" class="text-green-600 font-bold">0</span></span><span class="font-medium">üìã ‡∏•‡∏≤: <span id="summaryLeave" class="text-yellow-600 font-bold">0</span></span><span class="font-medium">‚ùå ‡∏Ç‡∏≤‡∏î: <span id="summaryAbsent" class="text-red-600 font-bold">0</span></span><span class="font-medium">üèÉ ‡∏´‡∏ô‡∏µ: <span id="summarySkipped" class="text-orange-600 font-bold">0</span></span></div></div>
                    <div class="mb-6 mt-6"><h4 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">üì∏</span>‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (2 ‡∏†‡∏≤‡∏û)</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="activityPhoto1" class="file-input-label p-4 rounded-lg flex flex-col items-center justify-center text-center"><span class="text-3xl">üñºÔ∏è</span><span class="mt-2 text-sm font-medium text-purple-700">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà 1</span><span class="text-xs text-gray-500">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</span></label><input type="file" id="activityPhoto1" class="hidden" accept="image/*" onchange="previewImage('activityPhoto1', 'photoPreview1')"><img id="photoPreview1" class="mt-2 rounded-lg image-preview hidden" alt="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà 1"></div><div><label for="activityPhoto2" class="file-input-label p-4 rounded-lg flex flex-col items-center justify-center text-center"><span class="text-3xl">üñºÔ∏è</span><span class="mt-2 text-sm font-medium text-purple-700">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà 2</span><span class="text-xs text-gray-500">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</span></label><input type="file" id="activityPhoto2" class="hidden" accept="image/*" onchange="previewImage('activityPhoto2', 'photoPreview2')"><img id="photoPreview2" class="mt-2 rounded-lg image-preview hidden" alt="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà 2"></div></div></div>
                    <div class="mb-6 mt-6"><h4 class="text-lg font-semibold mb-4 flex items-center"><span class="mr-2">‚≠ê</span>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h4><div class="space-y-3" id="rubricItems"></div></div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"><div><label class="block text-sm font-medium mb-2">üéØ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</label><input type="number" id="totalScore" min="0" max="100" class="w-full px-4 py-2 rounded-lg border" placeholder="0-100"></div><div><label class="block text-sm font-medium mb-2">üìä ‡∏£‡∏∞‡∏î‡∏±‡∏ö</label><select id="gradeLevel" class="w-full px-4 py-2 rounded-lg border"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö</option><option value="‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°">‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° (90-100)</option><option value="‡∏î‡∏µ‡∏°‡∏≤‡∏Å">‡∏î‡∏µ‡∏°‡∏≤‡∏Å (80-89)</option><option value="‡∏î‡∏µ">‡∏î‡∏µ (70-79)</option><option value="‡∏û‡∏≠‡πÉ‡∏ä‡πâ">‡∏û‡∏≠‡πÉ‡∏ä‡πâ (60-69)</option><option value="‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á">‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á (&lt;60)</option></select></div></div>
                    <div class="mb-6"><label class="block text-sm font-medium mb-2">üí¨ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô/‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå</label><textarea id="comments" rows="4" class="w-full px-4 py-2 rounded-lg border" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô..."></textarea></div>
                    <div class="mb-6"><label class="block text-sm font-medium mb-2">üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label><textarea id="notes" rows="3" class="w-full px-4 py-2 rounded-lg border" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea></div>
                    <div class="mb-6"><label class="block text-sm font-medium mb-2">‚úçÔ∏è ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label><div class="signature-pad rounded-lg p-4 text-center"><canvas id="signatureCanvas" width="300" height="100" class="border-2 border-dashed rounded-lg mx-auto cursor-crosshair"></canvas><div class="mt-2 space-x-2"><button type="button" onclick="clearSignature()" class="text-sm text-purple-600 hover:text-purple-800">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</button></div></div></div>
                    <div class="flex justify-end space-x-3"><button type="button" onclick="closeModal()" class="px-6 py-2 border rounded-lg">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" class="px-6 py-2 btn-primary text-white rounded-lg font-medium">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></div>
                </form>
            </div>
        </div>
    </div>
    <div id="dashboardModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md"><div class="flex items-center justify-between"><div class="flex items-center space-x-3"><span class="text-2xl">üìà</span><h3 class="text-xl font-bold">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h3></div><button onclick="closeDashboard()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button></div><div class="mt-4"><label for="dashboardGradeFilter" class="text-sm font-medium">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô:</label><select id="dashboardGradeFilter" onchange="renderDashboardCharts()" class="mt-1 w-full md:w-auto px-3 py-2 rounded-lg border focus:ring-2 focus:ring-purple-500"><option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option><option value="‡∏°.1">‡∏°.1</option><option value="‡∏°.2">‡∏°.2</option><option value="‡∏°.3">‡∏°.3</option></select></div></div>
            <div class="p-6 space-y-8"><div><h4 class="text-lg font-semibold mb-4">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</h4><div class="p-4 bg-gray-50 rounded-lg"><canvas id="attendanceChart"></canvas></div></div><div><h4 class="text-lg font-semibold mb-4">‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h4><div class="p-4 bg-gray-50 rounded-lg"><canvas id="scoreChart"></canvas></div></div></div>
        </div>
    </div>
    
    <div id="activityStatusModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col">
            <div class="p-6 border-b"><div class="flex items-center justify-between"><div class="flex items-center space-x-3"><span class="text-2xl">üìë</span><h3 class="text-xl font-bold">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3></div><button onclick="closeActivityStatusDashboard()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button></div></div>
            <div class="p-6 flex-grow overflow-y-auto">
                <div class="flex justify-between items-center border-b border-gray-200 mb-4"><nav id="statusTabs" class="flex space-x-4" aria-label="Tabs"><a href="#" onclick="renderActivityStatusTable('m1'); setActiveTab(this); return false;" class="status-tab text-purple-600 border-purple-600 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</a><a href="#" onclick="renderActivityStatusTable('m2'); setActiveTab(this); return false;" class="status-tab text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</a><a href="#" onclick="renderActivityStatusTable('m3'); setActiveTab(this); return false;" class="status-tab text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3</a></nav><button id="printGradeReportBtn" onclick="printGradeReport()" class="px-4 py-2 bg-blue-500 text-white text-sm font-medium rounded-lg hover:bg-blue-600">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button></div>
                <div class="overflow-x-auto"><table class="w-full"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡πÄ‡∏ß‡∏•‡∏≤</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°</th></tr></thead><tbody id="activityStatusTableBody" class="bg-white divide-y divide-gray-200"></tbody></table></div>
            </div>
        </div>
    </div>

    <div id="printArea" class="hidden font-sans"></div>
    
    <script>
    // ... (All JavaScript code remains exactly the same as the previous version) ...
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx_V2hmixpjY3JEv_u1yLThuAWyj5jiUL5mg8bT0Nafc7r5nT2onTOLB_zjIHzOumOV/exec';
    let studentData = {};
    let editingStudent = null;
    let canvas, ctx, isDrawing = false;
    let attendanceSummaryData = null;
    let activitySummaryData = null;
    let attendanceChartInstance = null;
    let scoreChartInstance = null;
    let recordedActivitiesData = null;
    let currentStatusGradeKey = 'm1';

    const scheduleData = {
        m1:{title:"‡∏°.1 - ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß",focus:"‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ß‡∏¥‡∏ô‡∏±‡∏¢ ‚Äì ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‚Äì ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà",schedule:[{time:"08.30 ‚Äì 09.00",day1:"‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û‡∏ò‡∏á‡∏ä‡∏≤‡∏ï‡∏¥",day2:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",day3:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á"},{time:"09.00 ‚Äì 10.00",day1:"‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß (‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô)",day2:"‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (2‚Äì3 ‡∏Å‡∏°.)",day3:"‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏î‡πÅ‡∏ú‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢"},{time:"10.00 ‚Äì 10.15",day1:"‡∏û‡∏±‡∏Å",day2:"‡∏û‡∏±‡∏Å",day3:"‡∏û‡∏±‡∏Å"},{time:"10.15 ‚Äì 11.15",day1:"‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏û‡∏¥‡∏£‡∏≠‡∏î, ‡∏ï‡∏∞‡∏Å‡∏£‡∏∏‡∏î‡πÄ‡∏ö‡πá‡∏î, ‡∏Ç‡∏±‡∏î‡∏™‡∏°‡∏≤‡∏ò‡∏¥)",day2:"‡∏ù‡∏∂‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®",day3:"‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡πÑ‡∏ü‡∏á‡πà‡∏≤‡∏¢ ‡πÜ"},{time:"11.15 ‚Äì 12.00",day1:"‡πÄ‡∏Å‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå",day2:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° Teamwork",day3:"‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ú‡∏π‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô"},{time:"12.00 ‚Äì 13.00",day1:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",day2:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",day3:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô"},{time:"13.00 ‚Äì 14.30",day1:"‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô",day2:"‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)",day3:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®)"},{time:"14.30 ‚Äì 15.30",day1:"‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏ú‡∏π‡πâ‡∏ï‡∏≤‡∏°",day2:"‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠",day3:"‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î (Reflection)"},{time:"15.30 ‚Äì 16.00",day1:"‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",day2:"‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",day3:"‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"}]},
        m2:{title:"‡∏°.2 - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö",focus:"‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ ‚Äì ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå ‚Äì ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏•‡∏à‡∏£‡∏¥‡∏á ‚Äì ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á",schedule:[{time:"08.30 ‚Äì 09.00",day1:"‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",day2:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",day3:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á"},{time:"09.00 ‚Äì 10.00",day1:"‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏°‡∏π‡πà, ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ñ‡∏ß)",day2:"‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (4‚Äì5 ‡∏Å‡∏°.)",day3:"‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î, ‡∏´‡∏≤‡∏°‡∏ú‡∏π‡πâ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö)"},{time:"10.00 ‚Äì 10.15",day1:"‡∏û‡∏±‡∏Å",day2:"‡∏û‡∏±‡∏Å",day3:"‡∏û‡∏±‡∏Å"},{time:"10.15 ‚Äì 11.15",day1:"‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå (‡∏ö‡πà‡∏ß‡∏á‡∏™‡∏≤‡∏¢‡∏ò‡∏ô‡∏π, ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏±‡∏ö‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤)",day2:"‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ / ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ",day3:"‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß"},{time:"11.15 ‚Äì 12.00",day1:"‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏ú‡∏π‡πâ‡∏ï‡∏≤‡∏°",day2:"‡∏ê‡∏≤‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏à/Team Building",day3:"‡πÄ‡∏Å‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå"},{time:"12.00 ‚Äì 13.00",day1:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",day2:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",day3:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô"},{time:"13.00 ‚Äì 14.30",day1:"‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà",day2:"‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡∏ä‡∏∏‡∏°‡∏ä‡∏ô/‡∏ß‡∏±‡∏î)",day3:"‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ê‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏® + ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)"},{time:"14.30 ‚Äì 15.30",day1:"‡πÄ‡∏Å‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡∏°",day2:"‡πÄ‡∏û‡∏•‡∏á‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á",day3:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î"},{time:"15.30 ‚Äì 16.00",day1:"‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",day2:"‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",day3:"‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"}]},
        m3:{title:"‡∏°.3 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î",focus:"‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥ ‚Äì ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‚Äì ‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î ‚Äì ‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ",schedule:[{time:"08.30 ‚Äì 09.00",day1:"‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",day2:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",day3:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á"},{time:"09.00 ‚Äì 10.00",day1:"‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤ (‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà)",day2:"‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (6‚Äì8 ‡∏Å‡∏°. + ‡∏ê‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á)",day3:"‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡∏î‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å, ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢)"},{time:"10.00 ‚Äì 10.15",day1:"‡∏û‡∏±‡∏Å",day2:"‡∏û‡∏±‡∏Å",day3:"‡∏û‡∏±‡∏Å"},{time:"10.15 ‚Äì 11.15",day1:"‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏ú‡∏π‡∏Å‡∏£‡∏≠‡∏Å, ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏™‡∏°‡∏≠)",day2:"‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô / ‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏ä‡∏∏‡∏°‡∏ä‡∏ô",day3:"‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î (‡∏´‡∏≤‡∏ô‡πâ‡∏≥, ‡∏´‡∏≤‡∏ó‡∏¥‡∏®‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß)"},{time:"11.15 ‚Äì 12.00",day1:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏†‡∏≤‡∏ß‡∏∞‡∏ú‡∏π‡πâ‡∏ô‡∏≥ (‡∏ù‡∏∂‡∏Å‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å)",day2:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏ê‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢",day3:"‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.3 ‡∏à‡∏±‡∏î‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á ‡∏°.1‚Äì‡∏°.2"},{time:"12.00 ‚Äì 13.00",day1:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",day2:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",day3:"‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô"},{time:"13.00 ‚Äì 14.30",day1:"‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®",day2:"‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏•‡πá‡∏Å ‡πÜ)",day3:"‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ê‡∏≤‡∏ô‡∏£‡∏ß‡∏° (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏® + ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• + ‡∏†‡∏≤‡∏ß‡∏∞‡∏ú‡∏π‡πâ‡∏ô‡∏≥)"},{time:"14.30 ‚Äì 15.30",day1:"‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à",day2:"‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå (Mini Camp Fire)",day3:"‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î"},{time:"15.30 ‚Äì 16.00",day1:"‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",day2:"‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",day3:"‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"}]}
    };
    const rubricCriteria = {
        default:[{criteria:"‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",maxScore:25},{criteria:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡πÉ‡∏ô‡∏ó‡∏µ‡∏°",maxScore:25},{criteria:"‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö",maxScore:25},{criteria:"‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö",maxScore:25}],
        skill:[{criteria:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ",maxScore:30},{criteria:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥",maxScore:25},{criteria:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",maxScore:25},{criteria:"‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á",maxScore:20}],
        leadership:[{criteria:"‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥",maxScore:30},{criteria:"‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£",maxScore:25},{criteria:"‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à",maxScore:25},{criteria:"‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å",maxScore:20}]
    };

    document.addEventListener('DOMContentLoaded', function () {
        fetchStudents();
        document.getElementById('gradeSelect').addEventListener('change', loadSchedule);
    });

    async function fetchStudents() {
        try {
            const response = await fetch(SCRIPT_URL + '?action=getStudents');
            if (!response.ok) throw new Error('Network response was not ok');
            studentData = await response.json();
        } catch (error) {
            console.error('Failed to fetch students:', error);
            Swal.fire({icon: 'error', title: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡∏´‡∏£‡∏∑‡∏≠ Google Apps Script', confirmButtonColor: '#8b5cf6'});
        } finally {
            loadSchedule();
        }
    }

    async function postData(payload) {
        try {
            const response = await fetch(SCRIPT_URL, {method: 'POST', mode: 'cors', headers: {'Content-Type': 'text/plain;charset=utf-8'}, body: JSON.stringify(payload)});
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const result = await response.json();
            if (result.status !== 'success') throw new Error(result.message || 'Unknown error');
            return result;
        } catch (error) {
            console.error('Error posting data:', error);
            throw error;
        }
    }
    
    // ... the rest of the JavaScript functions ...
    </script>
</body>
</html>
