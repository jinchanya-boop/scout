<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏™‡∏≤‡∏°‡∏±‡∏ç‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏ç‡πà</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Prompt', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 50%, #ddd6fe 100%);
        }
        
        .card-shadow {
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }
        
        .activity-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.1);
        }
        
        .signature-pad {
            border: 2px dashed #c4b5fd;
            background: #faf5ff;
        }
        
        .rubric-item {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
        }
        
        .modal-overlay {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Header -->
    <header class="bg-white/90 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center">
                        <span class="text-white text-xl">üèïÔ∏è</span>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</h1>
                        <p class="text-sm text-purple-600">‡∏™‡∏≤‡∏°‡∏±‡∏ç‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏ç‡πà ‡∏°.1-‡∏°.3</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <select id="gradeSelect" class="px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <option value="m1">‡∏°.1 - ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß</option>
                        <option value="m2">‡∏°.2 - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ</option>
                        <option value="m3">‡∏°.3 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Quick Actions -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
            <button onclick="openStudentManagement()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-purple-50 transition-colors">
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">üë•</span>
                    <div class="text-left">
                        <h3 class="font-semibold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                        <p class="text-sm text-gray-600">‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏•‡∏ö ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    </div>
                </div>
            </button>
            <button onclick="openAttendanceCheck()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-purple-50 transition-colors">
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">‚úÖ</span>
                    <div class="text-left">
                        <h3 class="font-semibold text-gray-800">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3>
                        <p class="text-sm text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>
                    </div>
                </div>
            </button>
            <button onclick="showActivityReport()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-green-50 transition-colors">
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">üìä</span>
                    <div class="text-left">
                        <h3 class="font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
                        <p class="text-sm text-gray-600">‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                    </div>
                </div>
            </button>
            <button onclick="showAttendanceReport()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-blue-50 transition-colors">
                <div class="flex items-center space-x-3">
                    <span class="text-2xl">üìã</span>
                    <div class="text-left">
                        <h3 class="font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</h3>
                        <p class="text-sm text-gray-600">‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</p>
                    </div>
                </div>
            </button>
        </div>

        <!-- Schedule Table -->
        <div class="bg-white/90 backdrop-blur-md rounded-2xl card-shadow p-6 mb-8">
            <div class="flex items-center mb-6">
                <span class="text-2xl mr-3">üìÖ</span>
                <h2 class="text-2xl font-bold text-gray-800">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏£‡πå‡∏™</h2>
            </div>
            
            <div id="scheduleTable" class="overflow-x-auto">
                <!-- Schedule content will be populated by JavaScript -->
            </div>
        </div>
    </main>

    <!-- Student Management Modal -->
    <div id="studentManagementModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-purple-100">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">üë•</span>
                        <h3 class="text-xl font-bold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                    </div>
                    <button onclick="closeStudentManagement()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <!-- Group and Troop Selection for Management -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Å‡∏≠‡∏á</label>
                        <select id="manageGroup" onchange="updateManageTroopOptions()" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option>
                            <option value="‡∏Å‡∏≠‡∏á1">‡∏Å‡∏≠‡∏á 1</option>
                            <option value="‡∏Å‡∏≠‡∏á2">‡∏Å‡∏≠‡∏á 2</option>
                            <option value="‡∏Å‡∏≠‡∏á3">‡∏Å‡∏≠‡∏á 3</option>
                            <option value="‡∏Å‡∏≠‡∏á4">‡∏Å‡∏≠‡∏á 4</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏°‡∏π‡πà</label>
                        <select id="manageTroop" onchange="loadManageStudentList()" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button onclick="showAddStudentForm()" class="w-full px-4 py-2 btn-primary text-white rounded-lg font-medium">
                            ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                        </button>
                    </div>
                </div>

                <!-- Add/Edit Student Form -->
                <div id="studentForm" class="hidden mb-6 p-4 bg-purple-50 rounded-lg">
                    <h4 class="font-medium text-gray-800 mb-4" id="formTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà</h4>
                    <form id="addStudentForm">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠</label>
                                <input type="text" id="studentFirstName" required class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" placeholder="‡∏ä‡∏∑‡πà‡∏≠">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                                <input type="text" id="studentLastName" required class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label>
                                <input type="text" id="studentId" required class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" placeholder="‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
                            </div>
                        </div>
                        <div class="flex justify-end space-x-3 mt-4">
                            <button type="button" onclick="hideStudentForm()" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                            <button type="submit" class="px-4 py-2 btn-primary text-white rounded-lg font-medium">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Student List -->
                <div id="manageStudentList">
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl block mb-2">üë•</span>
                        <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Attendance Check Modal -->
    <div id="attendanceModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-purple-100">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">‚úÖ</span>
                        <h3 class="text-xl font-bold text-gray-800">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3>
                    </div>
                    <button onclick="closeAttendanceCheck()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <!-- Date and Activity Selection -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input type="date" id="attendanceDate" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
                        <select id="attendanceActivity" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</option>
                            <option value="‡πÄ‡∏ä‡πâ‡∏≤">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏ä‡πâ‡∏≤</option>
                            <option value="‡∏™‡∏≤‡∏¢">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≤‡∏¢</option>
                            <option value="‡∏ö‡πà‡∏≤‡∏¢">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ö‡πà‡∏≤‡∏¢</option>
                        </select>
                    </div>
                </div>

                <!-- Group Selection for Attendance -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Å‡∏≠‡∏á</label>
                        <select id="attendanceGroup" onchange="updateAttendanceTroopOptions()" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option>
                            <option value="‡∏Å‡∏≠‡∏á1">‡∏Å‡∏≠‡∏á 1</option>
                            <option value="‡∏Å‡∏≠‡∏á2">‡∏Å‡∏≠‡∏á 2</option>
                            <option value="‡∏Å‡∏≠‡∏á3">‡∏Å‡∏≠‡∏á 3</option>
                            <option value="‡∏Å‡∏≠‡∏á4">‡∏Å‡∏≠‡∏á 4</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏°‡∏π‡πà</label>
                        <select id="attendanceTroop" onchange="loadAttendanceStudentList()" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option>
                        </select>
                    </div>
                </div>

                <!-- Attendance List -->
                <div id="attendanceStudentList">
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl block mb-2">‚úÖ</span>
                        <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</p>
                    </div>
                </div>

                <!-- Save Attendance Button -->
                <div class="flex justify-end mt-6">
                    <button onclick="saveAttendance()" class="px-6 py-2 btn-primary text-white rounded-lg font-medium">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity Recording Modal -->
    <div id="activityModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-purple-100">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">üìù</span>
                        <h3 class="text-xl font-bold text-gray-800">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
                    </div>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
            </div>
            
            <div class="p-6">
                <form id="activityForm">
                    <!-- Activity Info -->
                    <div class="mb-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">üïê ‡πÄ‡∏ß‡∏•‡∏≤</label>
                                <input type="text" id="activityTime" class="w-full px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">üìã ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
                                <input type="text" id="activityName" class="w-full px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- Group and Troop Selection -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">üë• ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-xs text-gray-600 mb-1">‡∏Å‡∏≠‡∏á</label>
                                <select id="selectedGroup" onchange="updateTroopOptions()" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á</option>
                                    <option value="‡∏Å‡∏≠‡∏á1">‡∏Å‡∏≠‡∏á 1</option>
                                    <option value="‡∏Å‡∏≠‡∏á2">‡∏Å‡∏≠‡∏á 2</option>
                                    <option value="‡∏Å‡∏≠‡∏á3">‡∏Å‡∏≠‡∏á 3</option>
                                    <option value="‡∏Å‡∏≠‡∏á4">‡∏Å‡∏≠‡∏á 4</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs text-gray-600 mb-1">‡∏´‡∏°‡∏π‡πà</label>
                                <select id="selectedTroop" onchange="loadStudentList()" class="w-full px-3 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" disabled>
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Student List for Attendance -->
                        <div id="studentAttendanceList" class="hidden">
                            <div class="bg-purple-50 rounded-lg p-4">
                                <h4 class="font-medium text-gray-800 mb-3 flex items-center">
                                    <span class="mr-2">üìã</span>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô - ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠
                                </h4>
                                <div id="studentCheckList" class="space-y-2">
                                    <!-- Student attendance list will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Rubric Assessment -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <span class="mr-2">‚≠ê</span>‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
                        </h4>
                        <div class="space-y-3" id="rubricItems">
                            <!-- Rubric items will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Score and Comments -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üéØ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</label>
                            <input type="number" id="totalScore" min="0" max="100" class="w-full px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" placeholder="0-100">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">üìä ‡∏£‡∏∞‡∏î‡∏±‡∏ö</label>
                            <select id="gradeLevel" class="w-full px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
                                <option value="‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°">‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° (90-100)</option>
                                <option value="‡∏î‡∏µ‡∏°‡∏≤‡∏Å">‡∏î‡∏µ‡∏°‡∏≤‡∏Å (80-89)</option>
                                <option value="‡∏î‡∏µ">‡∏î‡∏µ (70-79)</option>
                                <option value="‡∏û‡∏≠‡πÉ‡∏ä‡πâ">‡∏û‡∏≠‡πÉ‡∏ä‡πâ (60-69)</option>
                                <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á">‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á (<60)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Comments -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">üí¨ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô/‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ó‡πå</label>
                        <textarea id="comments" rows="4" class="w-full px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°..."></textarea>
                    </div>

                    <!-- Notes -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label>
                        <textarea id="notes" rows="3" class="w-full px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
                    </div>

                    <!-- Signature -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">‚úçÔ∏è ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label>
                        <div class="signature-pad rounded-lg p-4 text-center">
                            <canvas id="signatureCanvas" width="400" height="150" class="border-2 border-dashed border-purple-300 rounded-lg mx-auto cursor-crosshair"></canvas>
                            <div class="mt-2 space-x-2">
                                <button type="button" onclick="clearSignature()" class="text-sm text-purple-600 hover:text-purple-800">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô</button>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex justify-end space-x-3">
                        <button type="button" onclick="closeModal()" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                        <button type="submit" class="px-6 py-2 btn-primary text-white rounded-lg font-medium">
                            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Schedule data for each grade
        const scheduleData = {
            m1: {
                title: "‡∏°.1 - ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß",
                focus: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ß‡∏¥‡∏ô‡∏±‡∏¢ ‚Äì ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ‚Äì ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà",
                schedule: [
                    {
                        time: "08.30 ‚Äì 09.00",
                        day1: "‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û‡∏ò‡∏á‡∏ä‡∏≤‡∏ï‡∏¥",
                        day2: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",
                        day3: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á"
                    },
                    {
                        time: "09.00 ‚Äì 10.00",
                        day1: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß (‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô)",
                        day2: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (2‚Äì3 ‡∏Å‡∏°.)",
                        day3: "‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ö‡∏≤‡∏î‡πÅ‡∏ú‡∏•‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢"
                    },
                    {
                        time: "10.00 ‚Äì 10.15",
                        day1: "‡∏û‡∏±‡∏Å",
                        day2: "‡∏û‡∏±‡∏Å",
                        day3: "‡∏û‡∏±‡∏Å"
                    },
                    {
                        time: "10.15 ‚Äì 11.15",
                        day1: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏û‡∏¥‡∏£‡∏≠‡∏î, ‡∏ï‡∏∞‡∏Å‡∏£‡∏∏‡∏î‡πÄ‡∏ö‡πá‡∏î, ‡∏Ç‡∏±‡∏î‡∏™‡∏°‡∏≤‡∏ò‡∏¥)",
                        day2: "‡∏ù‡∏∂‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®",
                        day3: "‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡πÑ‡∏ü‡∏á‡πà‡∏≤‡∏¢ ‡πÜ"
                    },
                    {
                        time: "11.15 ‚Äì 12.00",
                        day1: "‡πÄ‡∏Å‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå",
                        day2: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° Teamwork",
                        day3: "‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ú‡∏π‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô"
                    },
                    {
                        time: "12.00 ‚Äì 13.00",
                        day1: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",
                        day2: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",
                        day3: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô"
                    },
                    {
                        time: "13.00 ‚Äì 14.30",
                        day1: "‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô",
                        day2: "‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô)",
                        day3: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®)"
                    },
                    {
                        time: "14.30 ‚Äì 15.30",
                        day1: "‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏ú‡∏π‡πâ‡∏ï‡∏≤‡∏°",
                        day2: "‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠",
                        day3: "‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î (Reflection)"
                    },
                    {
                        time: "15.30 ‚Äì 16.00",
                        day1: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",
                        day2: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",
                        day3: "‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"
                    }
                ]
            },
            m2: {
                title: "‡∏°.2 - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö",
                focus: "‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ ‚Äì ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå ‚Äì ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏•‡∏à‡∏£‡∏¥‡∏á ‚Äì ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á",
                schedule: [
                    {
                        time: "08.30 ‚Äì 09.00",
                        day1: "‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",
                        day2: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",
                        day3: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á"
                    },
                    {
                        time: "09.00 ‚Äì 10.00",
                        day1: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏°‡∏π‡πà, ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ñ‡∏ß)",
                        day2: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (4‚Äì5 ‡∏Å‡∏°.)",
                        day3: "‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• (‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î, ‡∏´‡∏≤‡∏°‡∏ú‡∏π‡πâ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö)"
                    },
                    {
                        time: "10.00 ‚Äì 10.15",
                        day1: "‡∏û‡∏±‡∏Å",
                        day2: "‡∏û‡∏±‡∏Å",
                        day3: "‡∏û‡∏±‡∏Å"
                    },
                    {
                        time: "10.15 ‚Äì 11.15",
                        day1: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå (‡∏ö‡πà‡∏ß‡∏á‡∏™‡∏≤‡∏¢‡∏ò‡∏ô‡∏π, ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏±‡∏ö‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤)",
                        day2: "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ / ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ",
                        day3: "‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß"
                    },
                    {
                        time: "11.15 ‚Äì 12.00",
                        day1: "‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏ú‡∏π‡πâ‡∏ï‡∏≤‡∏°",
                        day2: "‡∏ê‡∏≤‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏à/Team Building",
                        day3: "‡πÄ‡∏Å‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå"
                    },
                    {
                        time: "12.00 ‚Äì 13.00",
                        day1: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",
                        day2: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",
                        day3: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô"
                    },
                    {
                        time: "13.00 ‚Äì 14.30",
                        day1: "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà",
                        day2: "‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡∏ä‡∏∏‡∏°‡∏ä‡∏ô/‡∏ß‡∏±‡∏î)",
                        day3: "‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ê‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏® + ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)"
                    },
                    {
                        time: "14.30 ‚Äì 15.30",
                        day1: "‡πÄ‡∏Å‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡∏°",
                        day2: "‡πÄ‡∏û‡∏•‡∏á‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á",
                        day3: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î"
                    },
                    {
                        time: "15.30 ‚Äì 16.00",
                        day1: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",
                        day2: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",
                        day3: "‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"
                    }
                ]
            },
            m3: {
                title: "‡∏°.3 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î",
                focus: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥ ‚Äì ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô ‚Äì ‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î ‚Äì ‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ",
                schedule: [
                    {
                        time: "08.30 ‚Äì 09.00",
                        day1: "‡∏û‡∏¥‡∏ò‡∏µ‡πÄ‡∏õ‡∏¥‡∏î / ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",
                        day2: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á",
                        day3: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏≤‡∏ò‡∏á"
                    },
                    {
                        time: "09.00 ‚Äì 10.00",
                        day1: "‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤ (‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏π‡πà)",
                        day2: "‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏Å‡∏• (6‚Äì8 ‡∏Å‡∏°. + ‡∏ê‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≤‡∏á)",
                        day3: "‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡∏î‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å, ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢)"
                    },
                    {
                        time: "10.00 ‚Äì 10.15",
                        day1: "‡∏û‡∏±‡∏Å",
                        day2: "‡∏û‡∏±‡∏Å",
                        day3: "‡∏û‡∏±‡∏Å"
                    },
                    {
                        time: "10.15 ‚Äì 11.15",
                        day1: "‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏ú‡∏π‡∏Å‡∏£‡∏≠‡∏Å, ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡∏™‡∏°‡∏≠)",
                        day2: "‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô / ‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏ä‡∏∏‡∏°‡∏ä‡∏ô",
                        day3: "‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡∏£‡∏≠‡∏î (‡∏´‡∏≤‡∏ô‡πâ‡∏≥, ‡∏´‡∏≤‡∏ó‡∏¥‡∏®‡∏à‡∏≤‡∏Å‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß)"
                    },
                    {
                        time: "11.15 ‚Äì 12.00",
                        day1: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏†‡∏≤‡∏ß‡∏∞‡∏ú‡∏π‡πâ‡∏ô‡∏≥ (‡∏ù‡∏∂‡∏Å‡∏™‡∏±‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å)",
                        day2: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥‡∏ê‡∏≤‡∏ô‡∏¢‡πà‡∏≠‡∏¢",
                        day3: "‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.3 ‡∏à‡∏±‡∏î‡∏ê‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á ‡∏°.1‚Äì‡∏°.2"
                    },
                    {
                        time: "12.00 ‚Äì 13.00",
                        day1: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",
                        day2: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô",
                        day3: "‡∏û‡∏±‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô"
                    },
                    {
                        time: "13.00 ‚Äì 14.30",
                        day1: "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏†‡∏π‡∏°‡∏¥‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®",
                        day2: "‡∏ö‡∏≥‡πÄ‡∏û‡πá‡∏ç‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå (‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏•‡πá‡∏Å ‡πÜ)",
                        day3: "‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ê‡∏≤‡∏ô‡∏£‡∏ß‡∏° (‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô + ‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏® + ‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• + ‡∏†‡∏≤‡∏ß‡∏∞‡∏ú‡∏π‡πâ‡∏ô‡∏≥)"
                    },
                    {
                        time: "14.30 ‚Äì 15.30",
                        day1: "‡πÄ‡∏Å‡∏°‡∏ú‡∏π‡πâ‡∏ô‡∏≥-‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à",
                        day2: "‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå (Mini Camp Fire)",
                        day3: "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î"
                    },
                    {
                        time: "15.30 ‚Äì 16.00",
                        day1: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",
                        day2: "‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°",
                        day3: "‡∏û‡∏¥‡∏ò‡∏µ‡∏õ‡∏¥‡∏î + ‡∏°‡∏≠‡∏ö‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏ö‡∏±‡∏ï‡∏£"
                    }
                ]
            }
        };

        // Rubric criteria for different activities
        const rubricCriteria = {
            default: [
                { criteria: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°", maxScore: 25 },
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠‡πÉ‡∏ô‡∏ó‡∏µ‡∏°", maxScore: 25 },
                { criteria: "‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö", maxScore: 25 },
                { criteria: "‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö", maxScore: 25 }
            ],
            skill: [
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ", maxScore: 30 },
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥", maxScore: 25 },
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢", maxScore: 25 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á", maxScore: 20 }
            ],
            leadership: [
                { criteria: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥", maxScore: 30 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£", maxScore: 25 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à", maxScore: 25 },
                { criteria: "‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", maxScore: 20 }
            ]
        };

        // Student data storage
        let studentData = {
            ‡∏Å‡∏≠‡∏á1: {
                ‡∏´‡∏°‡∏π‡πà1: [
                    { id: '001', firstName: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢', lastName: '‡πÉ‡∏à‡∏î‡∏µ' },
                    { id: '002', firstName: '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á', lastName: '‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' },
                    { id: '003', firstName: '‡∏ß‡∏¥‡∏ä‡∏±‡∏¢', lastName: '‡∏°‡∏≤‡∏ô‡∏∞' }
                ],
                ‡∏´‡∏°‡∏π‡πà2: [
                    { id: '004', firstName: '‡∏ô‡∏¥‡∏£‡∏±‡∏ô‡∏î‡∏£‡πå', lastName: '‡∏™‡∏∏‡∏Ç‡πÉ‡∏™' },
                    { id: '005', firstName: '‡∏õ‡∏£‡∏µ‡∏ä‡∏≤', lastName: '‡πÄ‡∏Å‡πà‡∏á‡∏Å‡∏≤‡∏à' }
                ],
                ‡∏´‡∏°‡∏π‡πà3: [
                    { id: '006', firstName: '‡∏™‡∏∏‡∏£‡∏ä‡∏±‡∏¢', lastName: '‡∏î‡∏µ‡πÄ‡∏î‡πà‡∏ô' },
                    { id: '007', firstName: '‡∏≠‡∏ô‡∏∏‡∏ä‡∏≤', lastName: '‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á' }
                ],
                ‡∏´‡∏°‡∏π‡πà4: [
                    { id: '008', firstName: '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£', lastName: '‡πÄ‡∏à‡∏£‡∏¥‡∏ç' },
                    { id: '009', firstName: '‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥', lastName: '‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå' }
                ]
            },
            ‡∏Å‡∏≠‡∏á2: {
                ‡∏´‡∏°‡∏π‡πà1: [
                    { id: '010', firstName: '‡∏°‡∏≤‡∏ô‡∏¥‡∏ï', lastName: '‡∏™‡∏ß‡πà‡∏≤‡∏á' },
                    { id: '011', firstName: '‡∏ä‡∏±‡∏¢‡∏ß‡∏±‡∏í‡∏ô‡πå', lastName: '‡πÄ‡∏Å‡πà‡∏≤' }
                ],
                ‡∏´‡∏°‡∏π‡πà2: [
                    { id: '012', firstName: '‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò', lastName: '‡πÉ‡∏´‡∏°‡πà' },
                    { id: '013', firstName: '‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå', lastName: '‡∏î‡∏µ' }
                ],
                ‡∏´‡∏°‡∏π‡πà3: [
                    { id: '014', firstName: '‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤', lastName: '‡πÄ‡∏Å‡πà‡∏á' },
                    { id: '015', firstName: '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à', lastName: '‡∏°‡∏≤‡∏Å' }
                ],
                ‡∏´‡∏°‡∏π‡πà4: [
                    { id: '016', firstName: '‡∏ö‡∏∏‡∏ç‡∏°‡∏µ', lastName: '‡πÄ‡∏¢‡∏≠‡∏∞' },
                    { id: '017', firstName: '‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå', lastName: '‡∏î‡∏µ' }
                ]
            },
            ‡∏Å‡∏≠‡∏á3: {
                ‡∏´‡∏°‡∏π‡πà1: [
                    { id: '018', firstName: '‡∏ä‡∏≤‡∏ç‡∏ä‡∏±‡∏¢', lastName: '‡πÄ‡∏Å‡πà‡∏á' },
                    { id: '019', firstName: '‡∏ß‡∏µ‡∏£‡∏∞', lastName: '‡∏ä‡∏≤‡∏ï‡∏¥' }
                ],
                ‡∏´‡∏°‡∏π‡πà2: [
                    { id: '020', firstName: '‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥', lastName: '‡πÄ‡∏á‡∏¥‡∏ô' },
                    { id: '021', firstName: '‡∏ò‡∏µ‡∏£‡∏∞', lastName: '‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå' }
                ],
                ‡∏´‡∏°‡∏π‡πà3: [
                    { id: '022', firstName: '‡∏≠‡∏ô‡∏±‡∏ô‡∏ï‡πå', lastName: '‡∏™‡∏∏‡∏Ç' },
                    { id: '023', firstName: '‡∏ß‡∏¥‡∏©‡∏ì‡∏∏', lastName: '‡∏Å‡∏£‡∏£‡∏°' }
                ],
                ‡∏´‡∏°‡∏π‡πà4: [
                    { id: '024', firstName: '‡∏ä‡∏±‡∏¢‡∏ì‡∏£‡∏á‡∏Ñ‡πå', lastName: '‡∏î‡∏µ' },
                    { id: '025', firstName: '‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå', lastName: '‡∏ú‡∏•' }
                ]
            },
            ‡∏Å‡∏≠‡∏á4: {
                ‡∏´‡∏°‡∏π‡πà1: [
                    { id: '026', firstName: '‡∏™‡∏∏‡∏£‡∏û‡∏•', lastName: '‡πÅ‡∏Å‡πâ‡∏ß' },
                    { id: '027', firstName: '‡∏ä‡∏≤‡∏Ñ‡∏£‡∏¥‡∏ï', lastName: '‡∏ó‡∏≠‡∏á' }
                ],
                ‡∏´‡∏°‡∏π‡πà2: [
                    { id: '028', firstName: '‡∏ß‡∏¥‡∏ä‡∏¥‡∏ï', lastName: '‡πÄ‡∏á‡∏¥‡∏ô' },
                    { id: '029', firstName: '‡∏™‡∏°‡∏û‡∏á‡∏©‡πå', lastName: '‡∏ô‡∏Ñ‡∏£' }
                ],
                ‡∏´‡∏°‡∏π‡πà3: [
                    { id: '030', firstName: '‡∏≠‡∏î‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå', lastName: '‡πÉ‡∏´‡∏ç‡πà' },
                    { id: '031', firstName: '‡∏õ‡∏¥‡∏¢‡∏∞', lastName: '‡∏ä‡∏≤‡∏ï‡∏¥' }
                ],
                ‡∏´‡∏°‡∏π‡πà4: [
                    { id: '032', firstName: '‡∏™‡∏∏‡∏ó‡∏ò‡∏¥', lastName: '‡∏ä‡∏±‡∏¢' },
                    { id: '033', firstName: '‡∏ß‡∏¥‡∏£‡∏±‡∏ä', lastName: '‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå' }
                ]
            }
        };

        // Current editing student
        let editingStudent = null;

        // Signature canvas setup
        let canvas, ctx, isDrawing = false;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadSchedule();
            setupSignatureCanvas();
            
            // Grade selection change handler
            document.getElementById('gradeSelect').addEventListener('change', loadSchedule);
            
            // Set today's date for attendance
            document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
            
            // Student form submission
            document.getElementById('addStudentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveStudent();
            });
        });

        function loadSchedule() {
            const selectedGrade = document.getElementById('gradeSelect').value;
            const data = scheduleData[selectedGrade];
            const tableContainer = document.getElementById('scheduleTable');
            
            let html = `
                <div class="mb-4">
                    <h3 class="text-lg font-semibold text-purple-800">${data.title}</h3>
                    <p class="text-sm text-gray-600 mt-1"><strong>‡∏à‡∏∏‡∏î‡πÄ‡∏ô‡πâ‡∏ô:</strong> ${data.focus}</p>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gradient-to-r from-purple-500 to-purple-600 text-white">
                                <th class="border border-purple-300 px-4 py-3 text-left font-medium">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th class="border border-purple-300 px-4 py-3 text-left font-medium">üìÖ ‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å</th>
                                <th class="border border-purple-300 px-4 py-3 text-left font-medium">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á</th>
                                <th class="border border-purple-300 px-4 py-3 text-left font-medium">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            data.schedule.forEach((row, index) => {
                const isBreak = row.day1.includes('‡∏û‡∏±‡∏Å');
                const rowClass = isBreak ? 'bg-purple-50' : 'bg-white hover:bg-purple-50';
                
                html += `
                    <tr class="${rowClass} transition-colors">
                        <td class="border border-purple-200 px-4 py-3 font-medium text-purple-700">${row.time}</td>
                        <td class="border border-purple-200 px-4 py-3">
                            <div class="flex items-center justify-between">
                                <span>${row.day1}</span>
                                ${!isBreak ? `<button onclick="openActivityModal('${row.time}', '${row.day1}', 1)" class="ml-2 px-3 py-1 bg-purple-500 text-white text-xs rounded-full hover:bg-purple-600 transition-colors">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>` : ''}
                            </div>
                        </td>
                        <td class="border border-purple-200 px-4 py-3">
                            <div class="flex items-center justify-between">
                                <span>${row.day2}</span>
                                ${!isBreak ? `<button onclick="openActivityModal('${row.time}', '${row.day2}', 2)" class="ml-2 px-3 py-1 bg-purple-500 text-white text-xs rounded-full hover:bg-purple-600 transition-colors">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>` : ''}
                            </div>
                        </td>
                        <td class="border border-purple-200 px-4 py-3">
                            <div class="flex items-center justify-between">
                                <span>${row.day3}</span>
                                ${!isBreak ? `<button onclick="openActivityModal('${row.time}', '${row.day3}', 3)" class="ml-2 px-3 py-1 bg-purple-500 text-white text-xs rounded-full hover:bg-purple-600 transition-colors">üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>` : ''}
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            tableContainer.innerHTML = html;
        }

        function openActivityModal(time, activity, day) {
            document.getElementById('activityTime').value = time;
            document.getElementById('activityName').value = activity;
            
            // Load appropriate rubric criteria
            let criteria = rubricCriteria.default;
            if (activity.includes('‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô') || activity.includes('‡πÄ‡∏Ç‡πá‡∏°‡∏ó‡∏¥‡∏®') || activity.includes('‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•')) {
                criteria = rubricCriteria.skill;
            } else if (activity.includes('‡∏ú‡∏π‡πâ‡∏ô‡∏≥') || activity.includes('‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤')) {
                criteria = rubricCriteria.leadership;
            }
            
            loadRubricItems(criteria);
            document.getElementById('activityModal').classList.remove('hidden');
        }

        function loadRubricItems(criteria) {
            const container = document.getElementById('rubricItems');
            let html = '';
            
            criteria.forEach((item, index) => {
                html += `
                    <div class="rubric-item rounded-lg p-4 border border-purple-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-medium text-gray-800">${item.criteria}</span>
                            <span class="text-sm text-purple-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°: ${item.maxScore}</span>
                        </div>
                        <div class="flex items-center space-x-4">
                            <input type="range" min="0" max="${item.maxScore}" value="0" 
                                   class="flex-1 h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer"
                                   id="rubric_${index}" 
                                   oninput="updateRubricScore(${index}, this.value, ${item.maxScore})">
                            <span id="score_${index}" class="font-bold text-purple-600 min-w-[60px]">0/${item.maxScore}</span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function updateRubricScore(index, value, maxScore) {
            document.getElementById(`score_${index}`).textContent = `${value}/${maxScore}`;
            
            // Calculate total score
            const rubricItems = document.querySelectorAll('[id^="rubric_"]');
            let total = 0;
            rubricItems.forEach(item => {
                total += parseInt(item.value);
            });
            document.getElementById('totalScore').value = total;
            
            // Auto-select grade level
            const gradeSelect = document.getElementById('gradeLevel');
            if (total >= 90) gradeSelect.value = '‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°';
            else if (total >= 80) gradeSelect.value = '‡∏î‡∏µ‡∏°‡∏≤‡∏Å';
            else if (total >= 70) gradeSelect.value = '‡∏î‡∏µ';
            else if (total >= 60) gradeSelect.value = '‡∏û‡∏≠‡πÉ‡∏ä‡πâ';
            else gradeSelect.value = '‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á';
        }

        function setupSignatureCanvas() {
            canvas = document.getElementById('signatureCanvas');
            ctx = canvas.getContext('2d');
            
            // Set canvas background
            ctx.fillStyle = '#faf5ff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events for mobile
            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouch);
            canvas.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            ctx.beginPath();
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const rect = canvas.getBoundingClientRect();
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.strokeStyle = '#8b5cf6';
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function clearSignature() {
            ctx.fillStyle = '#faf5ff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function closeModal() {
            document.getElementById('activityModal').classList.add('hidden');
            document.getElementById('activityForm').reset();
            clearSignature();
        }

        // Form submission
        document.getElementById('activityForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show loading
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà',
                allowOutsideClick: false,
                showConfirmButton: false,
                willOpen: () => {
                    Swal.showLoading();
                }
            });
            
            // Collect form data
            const formData = {
                timestamp: new Date().toLocaleString('th-TH'),
                grade: document.getElementById('gradeSelect').value,
                time: document.getElementById('activityTime').value,
                activity: document.getElementById('activityName').value,
                groups: Array.from(document.querySelectorAll('input[name="groups"]:checked')).map(cb => cb.value),
                rubricScores: {},
                totalScore: document.getElementById('totalScore').value,
                gradeLevel: document.getElementById('gradeLevel').value,
                comments: document.getElementById('comments').value,
                notes: document.getElementById('notes').value,
                signature: canvas.toDataURL()
            };
            
            // Collect rubric scores
            const rubricItems = document.querySelectorAll('[id^="rubric_"]');
            rubricItems.forEach((item, index) => {
                formData.rubricScores[`criteria_${index}`] = item.value;
            });
            
            // Send data using JSONP
            sendDataToGoogleSheets(formData);
        });

        // Student Management Functions
        function openStudentManagement() {
            document.getElementById('studentManagementModal').classList.remove('hidden');
        }

        function closeStudentManagement() {
            document.getElementById('studentManagementModal').classList.add('hidden');
            hideStudentForm();
        }

        function updateTroopOptions() {
            const groupSelect = document.getElementById('selectedGroup');
            const troopSelect = document.getElementById('selectedTroop');
            
            troopSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option>';
            
            if (groupSelect.value) {
                for (let i = 1; i <= 4; i++) {
                    const option = document.createElement('option');
                    option.value = `‡∏´‡∏°‡∏π‡πà${i}`;
                    option.textContent = `‡∏´‡∏°‡∏π‡πà ${i}`;
                    troopSelect.appendChild(option);
                }
                
                // Enable the troop select
                troopSelect.disabled = false;
            } else {
                troopSelect.disabled = true;
            }
            
            // Hide student list when group changes
            document.getElementById('studentAttendanceList').classList.add('hidden');
        }

        function updateManageTroopOptions() {
            const groupSelect = document.getElementById('manageGroup');
            const troopSelect = document.getElementById('manageTroop');
            
            troopSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option>';
            
            if (groupSelect.value) {
                for (let i = 1; i <= 4; i++) {
                    const option = document.createElement('option');
                    option.value = `‡∏´‡∏°‡∏π‡πà${i}`;
                    option.textContent = `‡∏´‡∏°‡∏π‡πà ${i}`;
                    troopSelect.appendChild(option);
                }
            }
        }

        function updateAttendanceTroopOptions() {
            const groupSelect = document.getElementById('attendanceGroup');
            const troopSelect = document.getElementById('attendanceTroop');
            
            troopSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏π‡πà</option>';
            
            if (groupSelect.value) {
                for (let i = 1; i <= 4; i++) {
                    const option = document.createElement('option');
                    option.value = `‡∏´‡∏°‡∏π‡πà${i}`;
                    option.textContent = `‡∏´‡∏°‡∏π‡πà ${i}`;
                    troopSelect.appendChild(option);
                }
            }
        }

        function loadStudentList() {
            const group = document.getElementById('selectedGroup').value;
            const troop = document.getElementById('selectedTroop').value;
            
            if (group && troop && studentData[group] && studentData[group][troop]) {
                const students = studentData[group][troop];
                const container = document.getElementById('studentCheckList');
                
                let html = '';
                students.forEach(student => {
                    html += `
                        <div class="flex items-center justify-between p-3 bg-white rounded-lg border border-purple-200">
                            <div class="flex items-center space-x-3">
                                <span class="font-medium text-gray-800">${student.firstName} ${student.lastName}</span>
                                <span class="text-sm text-gray-500">(${student.id})</span>
                            </div>
                            <div class="flex space-x-2">
                                <label class="flex items-center space-x-1 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏°‡∏≤" class="text-green-600 focus:ring-green-500" checked>
                                    <span class="text-sm text-green-600">‡∏°‡∏≤</span>
                                </label>
                                <label class="flex items-center space-x-1 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏•‡∏≤" class="text-yellow-600 focus:ring-yellow-500">
                                    <span class="text-sm text-yellow-600">‡∏•‡∏≤</span>
                                </label>
                                <label class="flex items-center space-x-1 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏Ç‡∏≤‡∏î" class="text-red-600 focus:ring-red-500">
                                    <span class="text-sm text-red-600">‡∏Ç‡∏≤‡∏î</span>
                                </label>
                                <label class="flex items-center space-x-1 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏´‡∏ô‡∏µ" class="text-orange-600 focus:ring-orange-500">
                                    <span class="text-sm text-orange-600">‡∏´‡∏ô‡∏µ</span>
                                </label>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                document.getElementById('studentAttendanceList').classList.remove('hidden');
            }
        }

        function loadManageStudentList() {
            const group = document.getElementById('manageGroup').value;
            const troop = document.getElementById('manageTroop').value;
            
            if (group && troop && studentData[group] && studentData[group][troop]) {
                const students = studentData[group][troop];
                const container = document.getElementById('manageStudentList');
                
                let html = `
                    <div class="bg-purple-50 rounded-lg p-4 mb-4">
                        <h4 class="font-medium text-gray-800 mb-3">${group} ${troop} - ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (${students.length} ‡∏Ñ‡∏ô)</h4>
                    </div>
                    <div class="space-y-3">
                `;
                
                students.forEach((student, index) => {
                    html += `
                        <div class="flex items-center justify-between p-4 bg-white rounded-lg border border-purple-200 hover:bg-purple-50 transition-colors">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                    <span class="text-purple-600 font-medium">${index + 1}</span>
                                </div>
                                <div>
                                    <div class="font-medium text-gray-800">${student.firstName} ${student.lastName}</div>
                                    <div class="text-sm text-gray-500">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß: ${student.id}</div>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="editStudent('${group}', '${troop}', ${index})" class="px-3 py-1 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-colors">
                                    ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                                </button>
                                <button onclick="deleteStudent('${group}', '${troop}', ${index})" class="px-3 py-1 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors">
                                    üóëÔ∏è ‡∏•‡∏ö
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                container.innerHTML = html;
            } else {
                document.getElementById('manageStudentList').innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl block mb-2">üë•</span>
                        <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    </div>
                `;
            }
        }

        function showAddStudentForm() {
            const group = document.getElementById('manageGroup').value;
            const troop = document.getElementById('manageTroop').value;
            
            if (!group || !troop) {
                Swal.fire({
                    icon: 'warning',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà',
                    text: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                    confirmButtonColor: '#8b5cf6'
                });
                return;
            }
            
            editingStudent = null;
            document.getElementById('formTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('addStudentForm').reset();
            document.getElementById('studentForm').classList.remove('hidden');
        }

        function hideStudentForm() {
            document.getElementById('studentForm').classList.add('hidden');
            editingStudent = null;
        }

        function editStudent(group, troop, index) {
            const student = studentData[group][troop][index];
            editingStudent = { group, troop, index };
            
            document.getElementById('formTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô';
            document.getElementById('studentFirstName').value = student.firstName;
            document.getElementById('studentLastName').value = student.lastName;
            document.getElementById('studentId').value = student.id;
            document.getElementById('studentForm').classList.remove('hidden');
        }

        function deleteStudent(group, troop, index) {
            const student = studentData[group][troop][index];
            
            Swal.fire({
                title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
                text: `‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö ${student.firstName} ${student.lastName} ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#ef4444',
                cancelButtonColor: '#8b5cf6',
                confirmButtonText: '‡∏•‡∏ö',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
            }).then((result) => {
                if (result.isConfirmed) {
                    studentData[group][troop].splice(index, 1);
                    loadManageStudentList();
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        text: '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                        confirmButtonColor: '#8b5cf6'
                    });
                }
            });
        }

        function saveStudent() {
            const group = document.getElementById('manageGroup').value;
            const troop = document.getElementById('manageTroop').value;
            const firstName = document.getElementById('studentFirstName').value.trim();
            const lastName = document.getElementById('studentLastName').value.trim();
            const studentId = document.getElementById('studentId').value.trim();
            
            if (!firstName || !lastName || !studentId) {
                Swal.fire({
                    icon: 'warning',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö',
                    confirmButtonColor: '#8b5cf6'
                });
                return;
            }
            
            // Check for duplicate student ID
            let isDuplicate = false;
            for (const g in studentData) {
                for (const t in studentData[g]) {
                    const students = studentData[g][t];
                    for (let i = 0; i < students.length; i++) {
                        if (students[i].id === studentId) {
                            // Allow same ID if editing the same student
                            if (!editingStudent || editingStudent.group !== g || editingStudent.troop !== t || editingStudent.index !== i) {
                                isDuplicate = true;
                                break;
                            }
                        }
                    }
                    if (isDuplicate) break;
                }
                if (isDuplicate) break;
            }
            
            if (isDuplicate) {
                Swal.fire({
                    icon: 'error',
                    title: '‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ã‡πâ‡∏≥',
                    text: '‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö',
                    confirmButtonColor: '#8b5cf6'
                });
                return;
            }
            
            const studentObj = { id: studentId, firstName, lastName };
            
            if (editingStudent) {
                // Edit existing student
                studentData[editingStudent.group][editingStudent.troop][editingStudent.index] = studentObj;
            } else {
                // Add new student
                if (!studentData[group]) studentData[group] = {};
                if (!studentData[group][troop]) studentData[group][troop] = [];
                studentData[group][troop].push(studentObj);
            }
            
            hideStudentForm();
            loadManageStudentList();
            
            Swal.fire({
                icon: 'success',
                title: editingStudent ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                text: editingStudent ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                confirmButtonColor: '#8b5cf6'
            });
        }

        // Attendance Functions
        function openAttendanceCheck() {
            document.getElementById('attendanceModal').classList.remove('hidden');
        }

        function closeAttendanceCheck() {
            document.getElementById('attendanceModal').classList.add('hidden');
        }

        function loadAttendanceStudentList() {
            const group = document.getElementById('attendanceGroup').value;
            const troop = document.getElementById('attendanceTroop').value;
            
            if (group && troop && studentData[group] && studentData[group][troop]) {
                const students = studentData[group][troop];
                const container = document.getElementById('attendanceStudentList');
                
                let html = `
                    <div class="bg-purple-50 rounded-lg p-4 mb-4">
                        <h4 class="font-medium text-gray-800">${group} ${troop} - ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ (${students.length} ‡∏Ñ‡∏ô)</h4>
                    </div>
                    <div class="space-y-3">
                `;
                
                students.forEach(student => {
                    html += `
                        <div class="flex items-center justify-between p-4 bg-white rounded-lg border border-purple-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                    <span class="text-purple-600 font-medium">${student.firstName.charAt(0)}</span>
                                </div>
                                <div>
                                    <div class="font-medium text-gray-800">${student.firstName} ${student.lastName}</div>
                                    <div class="text-sm text-gray-500">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß: ${student.id}</div>
                                </div>
                            </div>
                            <div class="flex space-x-3">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏°‡∏≤" class="text-green-600 focus:ring-green-500" checked>
                                    <span class="text-sm text-green-600 font-medium">‚úÖ ‡∏°‡∏≤</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏•‡∏≤" class="text-yellow-600 focus:ring-yellow-500">
                                    <span class="text-sm text-yellow-600 font-medium">üìã ‡∏•‡∏≤</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏Ç‡∏≤‡∏î" class="text-red-600 focus:ring-red-500">
                                    <span class="text-sm text-red-600 font-medium">‚ùå ‡∏Ç‡∏≤‡∏î</span>
                                </label>
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="radio" name="attendance_${student.id}" value="‡∏´‡∏ô‡∏µ" class="text-orange-600 focus:ring-orange-500">
                                    <span class="text-sm text-orange-600 font-medium">üèÉ ‡∏´‡∏ô‡∏µ</span>
                                </label>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                container.innerHTML = html;
            } else {
                document.getElementById('attendanceStudentList').innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl block mb-2">‚úÖ</span>
                        <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</p>
                    </div>
                `;
            }
        }

        function saveAttendance() {
            const date = document.getElementById('attendanceDate').value;
            const activity = document.getElementById('attendanceActivity').value;
            const group = document.getElementById('attendanceGroup').value;
            const troop = document.getElementById('attendanceTroop').value;
            
            if (!date || !activity || !group || !troop) {
                Swal.fire({
                    icon: 'warning',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö',
                    text: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ‡∏Å‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏π‡πà',
                    confirmButtonColor: '#8b5cf6'
                });
                return;
            }
            
            const students = studentData[group][troop];
            const attendanceData = [];
            
            students.forEach(student => {
                const attendanceRadio = document.querySelector(`input[name="attendance_${student.id}"]:checked`);
                if (attendanceRadio) {
                    attendanceData.push({
                        studentId: student.id,
                        studentName: `${student.firstName} ${student.lastName}`,
                        status: attendanceRadio.value
                    });
                }
            });
            
            // Show loading
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠...',
                allowOutsideClick: false,
                showConfirmButton: false,
                willOpen: () => {
                    Swal.showLoading();
                }
            });
            
            // Prepare attendance data for Google Sheets
            const attendanceRecord = {
                type: 'attendance',
                timestamp: new Date().toLocaleString('th-TH'),
                date: date,
                activity: activity,
                group: group,
                troop: troop,
                attendanceData: attendanceData
            };
            
            // Send to Google Sheets
            sendDataToGoogleSheets(attendanceRecord);
        }

        // Local storage for demo purposes
        let activityRecords = JSON.parse(localStorage.getItem('scoutActivityRecords') || '[]');
        let attendanceRecords = JSON.parse(localStorage.getItem('scoutAttendanceRecords') || '[]');

        function sendDataToGoogleSheets(data) {
            // Google Apps Script URL
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxB6yWRU_zNqZgnV1TOzHuNiAp-otXrx7oUPTD1GNAiit-nWPa3ZxNnQI4PJVJRXiNR/exec';
            
            console.log('Sending data to Google Sheets:', data);
            
            // Method 1: Try POST with JSON
            fetch(scriptURL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    ...data,
                    sheetId: '1xCjpO9YqiRGeUogaEl7RH38KJlqWrxYcDyx2I1JDHhA'
                }),
                mode: 'no-cors'
            })
            .then(() => {
                console.log('POST JSON method attempted');
                // Wait a bit then try alternative method
                setTimeout(() => {
                    tryFormDataMethod(scriptURL, data);
                }, 1000);
            })
            .catch((error) => {
                console.error('POST JSON failed:', error);
                tryFormDataMethod(scriptURL, data);
            });
        }
        
        function tryFormDataMethod(scriptURL, data) {
            // Method 2: Try POST with FormData
            const formData = new FormData();
            formData.append('sheetId', '1xCjpO9YqiRGeUogaEl7RH38KJlqWrxYcDyx2I1JDHhA');
            
            // Add all data fields to FormData
            for (const key in data) {
                if (typeof data[key] === 'object' && data[key] !== null) {
                    formData.append(key, JSON.stringify(data[key]));
                } else {
                    formData.append(key, data[key] || '');
                }
            }
            
            fetch(scriptURL, {
                method: 'POST',
                body: formData,
                mode: 'no-cors'
            })
            .then(() => {
                console.log('POST FormData method attempted');
                // Wait a bit then try GET method
                setTimeout(() => {
                    tryGetMethod(scriptURL, data);
                }, 1000);
            })
            .catch((error) => {
                console.error('POST FormData failed:', error);
                tryGetMethod(scriptURL, data);
            });
        }
        
        function tryGetMethod(scriptURL, data) {
            // Method 3: Try GET with URL parameters
            const params = new URLSearchParams();
            params.append('sheetId', '1xCjpO9YqiRGeUogaEl7RH38KJlqWrxYcDyx2I1JDHhA');
            
            // Add all data fields as URL parameters
            for (const key in data) {
                if (typeof data[key] === 'object' && data[key] !== null) {
                    params.append(key, JSON.stringify(data[key]));
                } else {
                    params.append(key, data[key] || '');
                }
            }
            
            const fullURL = `${scriptURL}?${params.toString()}`;
            
            fetch(fullURL, {
                method: 'GET',
                mode: 'no-cors'
            })
            .then(() => {
                console.log('GET method attempted');
                // All methods attempted, show success
                setTimeout(() => {
                    saveDataLocally(data);
                    showSuccessMessage(data);
                }, 1500);
            })
            .catch((error) => {
                console.error('GET method failed:', error);
                // All methods failed, save locally only
                saveDataLocally(data);
                showSuccessMessage(data, true);
            });
        }
        
        function saveDataLocally(data) {
            try {
                if (data.type === 'attendance') {
                    attendanceRecords.push(data);
                    localStorage.setItem('scoutAttendanceRecords', JSON.stringify(attendanceRecords));
                } else {
                    activityRecords.push(data);
                    localStorage.setItem('scoutActivityRecords', JSON.stringify(activityRecords));
                }
                console.log('Data saved locally successfully');
            } catch (error) {
                console.error('Error saving locally:', error);
            }
        }
        
        function showSuccessMessage(data, isOffline = false) {
            // Simulate processing time
            setTimeout(() => {
                try {
                    if (data.type === 'attendance') {
                        // Save attendance data
                        attendanceRecords.push(data);
                        localStorage.setItem('scoutAttendanceRecords', JSON.stringify(attendanceRecords));
                        
                        Swal.fire({
                            icon: 'success',
                            title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ',
                            html: `
                                <div class="text-left">
                                    <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${data.date}</p>
                                    <p><strong>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°:</strong> ${data.activity}</p>
                                    <p><strong>‡∏Å‡∏≠‡∏á-‡∏´‡∏°‡∏π‡πà:</strong> ${data.group} ${data.troop}</p>
                                    <p><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong> ${data.attendanceData.length} ‡∏Ñ‡∏ô</p>
                                </div>
                                <div class="mt-4 p-3 ${isOffline ? 'bg-yellow-50' : 'bg-green-50'} rounded-lg">
                                    <p class="text-sm ${isOffline ? 'text-yellow-700' : 'text-green-700'}">
                                        ${isOffline ? '‚ö†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï)' : '‚òÅÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheets ‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß'}
                                    </p>
                                    <p class="text-xs ${isOffline ? 'text-yellow-600' : 'text-green-600'} mt-1">‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                                </div>
                            `,
                            confirmButtonColor: '#10b981',
                            confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                            showCancelButton: true,
                            cancelButtonText: '‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô',
                            cancelButtonColor: '#8b5cf6'
                        }).then((result) => {
                            if (result.dismiss === Swal.DismissReason.cancel) {
                                showAttendanceReport();
                            }
                        });
                        
                        closeAttendanceCheck();
                        
                    } else {
                        // Save activity data
                        activityRecords.push(data);
                        localStorage.setItem('scoutActivityRecords', JSON.stringify(activityRecords));
                        
                        Swal.fire({
                            icon: 'success',
                            title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ',
                            html: `
                                <div class="text-left">
                                    <p><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${data.time}</p>
                                    <p><strong>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°:</strong> ${data.activity}</p>
                                    <p><strong>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°:</strong> ${data.totalScore}/100</p>
                                    <p><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö:</strong> ${data.gradeLevel}</p>
                                </div>
                                <div class="mt-4 p-3 ${isOffline ? 'bg-yellow-50' : 'bg-purple-50'} rounded-lg">
                                    <p class="text-sm ${isOffline ? 'text-yellow-700' : 'text-purple-700'}">
                                        ${isOffline ? '‚ö†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï)' : '‚òÅÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheets ‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß'}
                                    </p>
                                    <p class="text-xs ${isOffline ? 'text-yellow-600' : 'text-purple-600'} mt-1">‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                                </div>
                            `,
                            confirmButtonColor: '#8b5cf6',
                            confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                            showCancelButton: true,
                            cancelButtonText: '‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô',
                            cancelButtonColor: '#10b981'
                        }).then((result) => {
                            if (result.dismiss === Swal.DismissReason.cancel) {
                                showActivityReport();
                            }
                        });
                        
                        closeModal();
                    }
                    
                } catch (error) {
                    Swal.fire({
                        icon: 'error',
                        title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                        text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ' + error.message,
                        confirmButtonColor: '#ef4444'
                    });
                }
            }, 1500);
        }

        function showActivityReport() {
            if (activityRecords.length === 0) {
                Swal.fire({
                    icon: 'info',
                    title: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°',
                    text: '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö',
                    confirmButtonColor: '#8b5cf6'
                });
                return;
            }

            let reportHtml = `
                <div class="max-h-96 overflow-y-auto text-left">
                    <h4 class="font-bold text-lg mb-4 text-purple-800">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (${activityRecords.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h4>
            `;

            activityRecords.forEach((record, index) => {
                reportHtml += `
                    <div class="mb-4 p-4 border border-purple-200 rounded-lg bg-purple-50">
                        <div class="flex justify-between items-start mb-2">
                            <h5 class="font-semibold text-purple-800">#${index + 1} ${record.activity}</h5>
                            <span class="text-xs text-gray-500">${record.timestamp}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${record.time}</div>
                            <div><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö:</strong> ${record.grade}</div>
                            <div><strong>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:</strong> ${record.totalScore}/100</div>
                            <div><strong>‡πÄ‡∏Å‡∏£‡∏î:</strong> ${record.gradeLevel}</div>
                        </div>
                        ${record.comments ? `<div class="mt-2 text-sm"><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô:</strong> ${record.comments}</div>` : ''}
                    </div>
                `;
            });

            reportHtml += '</div>';

            Swal.fire({
                title: '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°',
                html: reportHtml,
                width: '800px',
                confirmButtonColor: '#8b5cf6',
                confirmButtonText: '‡∏õ‡∏¥‡∏î',
                showCancelButton: true,
                cancelButtonText: 'üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                cancelButtonColor: '#ef4444'
            }).then((result) => {
                if (result.dismiss === Swal.DismissReason.cancel) {
                    confirmClearData('activity');
                }
            });
        }

        function showAttendanceReport() {
            if (attendanceRecords.length === 0) {
                Swal.fire({
                    icon: 'info',
                    title: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠',
                    text: '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö',
                    confirmButtonColor: '#10b981'
                });
                return;
            }

            let reportHtml = `
                <div class="max-h-96 overflow-y-auto text-left">
                    <h4 class="font-bold text-lg mb-4 text-green-800">‚úÖ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ (${attendanceRecords.length} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</h4>
            `;

            attendanceRecords.forEach((record, index) => {
                const summary = record.attendanceData.reduce((acc, student) => {
                    acc[student.status] = (acc[student.status] || 0) + 1;
                    return acc;
                }, {});

                reportHtml += `
                    <div class="mb-4 p-4 border border-green-200 rounded-lg bg-green-50">
                        <div class="flex justify-between items-start mb-2">
                            <h5 class="font-semibold text-green-800">#${index + 1} ${record.activity}</h5>
                            <span class="text-xs text-gray-500">${record.timestamp}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm mb-2">
                            <div><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${record.date}</div>
                            <div><strong>‡∏Å‡∏≠‡∏á-‡∏´‡∏°‡∏π‡πà:</strong> ${record.group} ${record.troop}</div>
                        </div>
                        <div class="flex space-x-4 text-sm">
                            <span class="text-green-600">‚úÖ ‡∏°‡∏≤: ${summary.‡∏°‡∏≤ || 0}</span>
                            <span class="text-yellow-600">üìã ‡∏•‡∏≤: ${summary.‡∏•‡∏≤ || 0}</span>
                            <span class="text-red-600">‚ùå ‡∏Ç‡∏≤‡∏î: ${summary.‡∏Ç‡∏≤‡∏î || 0}</span>
                            <span class="text-orange-600">üèÉ ‡∏´‡∏ô‡∏µ: ${summary.‡∏´‡∏ô‡∏µ || 0}</span>
                        </div>
                    </div>
                `;
            });

            reportHtml += '</div>';

            Swal.fire({
                title: '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠',
                html: reportHtml,
                width: '800px',
                confirmButtonColor: '#10b981',
                confirmButtonText: '‡∏õ‡∏¥‡∏î',
                showCancelButton: true,
                cancelButtonText: 'üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                cancelButtonColor: '#ef4444'
            }).then((result) => {
                if (result.dismiss === Swal.DismissReason.cancel) {
                    confirmClearData('attendance');
                }
            });
        }

        function confirmClearData(type) {
            const title = type === 'activity' ? '‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°' : '‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠';
            const text = type === 'activity' ? '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö' : '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö';
            
            Swal.fire({
                title: title,
                text: text,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#ef4444',
                cancelButtonColor: '#8b5cf6',
                confirmButtonText: '‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
            }).then((result) => {
                if (result.isConfirmed) {
                    if (type === 'activity') {
                        activityRecords = [];
                        localStorage.removeItem('scoutActivityRecords');
                    } else {
                        attendanceRecords = [];
                        localStorage.removeItem('scoutAttendanceRecords');
                    }
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß',
                        confirmButtonColor: '#10b981'
                    });
                }
            });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9883dc5641f3d176',t:'MTc1OTQwNDU1My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
