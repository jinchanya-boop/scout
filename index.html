<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Prompt', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 50%, #ddd6fe 100%); }
        .card-shadow { box-shadow: 0 4px 20px rgba(139, 92, 246, 0.1); }
        .btn-primary { background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); transition: all 0.3s ease; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3); }
        .signature-pad { border: 2px dashed #c4b5fd; background: #faf5ff; }
        .rubric-item { background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); }
        .modal-overlay { background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px); }
        .file-input-label { cursor: pointer; background-color: #f3e8ff; border: 2px dashed #c4b5fd; }
        .file-input-label:hover { background-color: #e9d5ff; }
        .image-preview { width: 100%; height: 150px; object-fit: cover; border: 1px solid #ddd6fe; }

        /* START: PRINT STYLES */
        @media print {
            body * {
                visibility: hidden;
            }
            #printArea, #printArea * {
                visibility: visible;
            }
            #printArea {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            .print-no-break {
                page-break-inside: avoid;
            }
            /* NEW: Hide buttons in print view */
            .print-hide {
                display: none;
            }
        }
        /* END: PRINT STYLES */
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <header class="bg-white/90 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <img src="https://img2.pic.in.th/pic/sa1.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤" class="w-12 h-12 rounded-full object-cover">
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">‡πÅ‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤</h1>
                        <p class="text-sm text-purple-600"> ‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠ ‡∏°.1-‡∏°.3</p>
                    </div>
                </div>

                <select id="gradeSelect" class="px-4 py-2 rounded-lg border border-purple-200 focus:ring-2 focus:ring-purple-500">
                    <option value="m1">‡∏°.1 - ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß</option>
                    <option value="m2">‡∏°.2 - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ</option>
                    <option value="m3">‡∏°.3 - ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥</option>
                </select>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8">
            <button onclick="openStudentManagement()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-purple-50 transition-colors">
                <div class="flex items-center space-x-3"><span class="text-2xl">üë•</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3><p class="text-sm text-gray-600">‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏•‡∏ö ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</p></div></div>
            </button>
            <button onclick="openAttendanceCheck()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-purple-50 transition-colors">
                <div class="flex items-center space-x-3"><span class="text-2xl">‚úÖ</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h3><p class="text-sm text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</p></div></div>
            </button>
            <button onclick="openActivityStatusDashboard()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-indigo-50 transition-colors">
                <div class="flex items-center space-x-3"><span class="text-2xl">üìë</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3><p class="text-sm text-gray-600">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå</p></div></div>
            </button>
            <button onclick="openDashboard()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-blue-50 transition-colors">
                <div class="flex items-center space-x-3"><span class="text-2xl">üìà</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h3><p class="text-sm text-gray-600">‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</p></div></div>
            </button>
            <button onclick="showActivityReport()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-green-50 transition-colors">
                <div class="flex items-center space-x-3"><span class="text-2xl">üìä</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3><p class="text-sm text-gray-600">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p></div></div>
            </button>
            <button onclick="showAttendanceReport()" class="bg-white/90 backdrop-blur-md rounded-xl card-shadow p-4 hover:bg-yellow-50 transition-colors">
                <div class="flex items-center space-x-3"><span class="text-2xl">üìã</span><div class="text-left"><h3 class="font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</h3><p class="text-sm text-gray-600">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</p></div></div>
            </button>
        </div>
        <div class="bg-white/90 backdrop-blur-md rounded-2xl card-shadow p-6 mb-8">
            <div class="flex items-center mb-6"><span class="text-2xl mr-3">üìÖ</span><h2 class="text-2xl font-bold text-gray-800">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ Block Course</h2></div>
            <div id="scheduleTable" class="overflow-x-auto"></div>
        </div>
    </main>

    <div id="studentManagementModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">...</div>
    <div id="attendanceModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">...</div>
    <div id="activityModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">...</div>
    <div id="dashboardModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">...</div>
    
    <div id="activityStatusModal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3"><span class="text-2xl">üìë</span><h3 class="text-xl font-bold">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3></div>
                    <button onclick="closeActivityStatusDashboard()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
            </div>
            
            <div class="p-4 border-b bg-gray-50 flex justify-end">
                 <button onclick="printGradeReport()" class="btn-primary text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center">
                    <span class="mr-2">üñ®Ô∏è</span> ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏µ‡πâ
                </button>
            </div>
            <div class="p-6 flex-grow overflow-y-auto">
                <div class="border-b border-gray-200 mb-4">
                    <nav id="statusTabs" class="flex space-x-4" aria-label="Tabs">
                        <a href="#" onclick="renderActivityStatusTable('m1'); setActiveTab(this); return false;" class="status-tab text-purple-600 border-purple-600 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1</a>
                        <a href="#" onclick="renderActivityStatusTable('m2'); setActiveTab(this); return false;" class="status-tab text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2</a>
                        <a href="#" onclick="renderActivityStatusTable('m3'); setActiveTab(this); return false;" class="status-tab text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3</a>
                    </nav>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°</th>
                            </tr>
                        </thead>
                        <tbody id="activityStatusTableBody" class="bg-white divide-y divide-gray-200">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div id="printArea" class="hidden font-sans"></div>

    <script>
    // ... (All existing JS variables: SCRIPT_URL, studentData, etc.) ...
    const SCRIPT_URL = '...'; // Your script URL
    let studentData = {};
    let editingStudent = null;
    let canvas, ctx, isDrawing = false;
    let attendanceSummaryData = null;
    let activitySummaryData = null;
    let attendanceChartInstance = null;
    let scoreChartInstance = null;
    let recordedActivitiesData = null; 
    let currentStatusGrade = 'm1'; 

    const scheduleData = { /* ... Your existing schedule data ... */ };
    const rubricCriteria = { /* ... Your existing rubric data ... */ };
    
    // ... (All existing JS functions: DOMContentLoaded, fetchStudents, postData, Dashboard functions, UI & Display, Student Management, Attendance & Activity) ...
    
    // START: MODIFIED AND NEW FUNCTIONS
    
    // No changes to these functions, they are here for context
    async function openActivityStatusDashboard() {
        document.getElementById('activityStatusModal').classList.remove('hidden');
        Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
        try {
            const response = await fetch(SCRIPT_URL + '?action=getRecordedActivities');
            if (!response.ok) throw new Error('Failed to fetch recorded activities.');
            recordedActivitiesData = await response.json();
            renderActivityStatusTable('m1');
            setActiveTab(document.querySelector('.status-tab')); 
        } catch (error) {
            console.error(error);
            Swal.fire('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏î‡πâ', 'error');
        } finally {
            Swal.close();
        }
    }

    function closeActivityStatusDashboard() {
        document.getElementById('activityStatusModal').classList.add('hidden');
    }

    function setActiveTab(selectedTab) {
        document.querySelectorAll('.status-tab').forEach(tab => {
            tab.classList.remove('text-purple-600', 'border-purple-600');
            tab.classList.add('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
        });
        selectedTab.classList.add('text-purple-600', 'border-purple-600');
        selectedTab.classList.remove('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
    }

    function renderActivityStatusTable(gradeKey) {
        currentStatusGrade = gradeKey;
        const gradeMap = { 'm1': '‡∏°.1', 'm2': '‡∏°.2', 'm3': '‡∏°.3' };
        const gradeThai = gradeMap[gradeKey];
        const schedule = scheduleData[gradeKey].schedule;
        const recordedList = recordedActivitiesData[gradeThai] || [];
        const tableBody = document.getElementById('activityStatusTableBody');
        tableBody.innerHTML = '';

        schedule.forEach(row => {
            const isBreak = row.day1.includes('‡∏û‡∏±‡∏Å');
            let tableRow = `<tr class="${isBreak ? 'bg-gray-50' : ''}">`;
            tableRow += `<td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.time}</td>`;
            
            ['day1', 'day2', 'day3'].forEach((day, index) => {
                const activityName = row[day];
                const isRecorded = recordedList.includes(activityName);
                
                tableRow += `<td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">`;
                if (!isBreak) {
                    tableRow += `<div>${activityName}</div>`;
                    if (isRecorded) {
                        tableRow += `<div class="mt-2"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</span> <button onclick="printActivityRecord('${gradeThai}', '${activityName.replace(/'/g, "\\'")}')" class="ml-2 text-xs text-blue-600 hover:underline">‡∏î‡∏π/‡∏û‡∏¥‡∏°‡∏û‡πå</button></div>`;
                    } else {
                        tableRow += `<div class="mt-2"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">üÖæÔ∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span> <button onclick="openActivityModal('${row.time}', '${activityName.replace(/'/g, "\\'")}', ${index + 1})" class="ml-2 text-xs text-purple-600 hover:underline">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>`;
                    }
                } else {
                    tableRow += activityName;
                }
                tableRow += `</td>`;
            });
            tableRow += `</tr>`;
            tableBody.innerHTML += tableRow;
        });
    }
    
    // Existing function, no changes needed
    async function printActivityRecord(grade, activityName) { /* ... Your existing function ... */ }

    /**
     * NEW FUNCTION: Prints a summary report for the currently selected grade level.
     */
    async function printGradeReport() {
        const gradeKey = currentStatusGrade;
        if (!scheduleData[gradeKey] || !recordedActivitiesData) {
            Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', 'error');
            return;
        }

        const gradeInfo = scheduleData[gradeKey];
        const gradeMap = { 'm1': '‡∏°.1', 'm2': '‡∏°.2', 'm3': '‡∏°.3' };
        const gradeThai = gradeMap[gradeKey];
        const recordedList = recordedActivitiesData[gradeThai] || [];

        let totalActivities = 0;
        let recordedCount = 0;

        let reportTable = '';
        gradeInfo.schedule.forEach(row => {
            const isBreak = row.day1.includes('‡∏û‡∏±‡∏Å');
            if (isBreak) return; // Skip break times in the report table

            reportTable += '<tr>';
            reportTable += `<td class="border p-2 font-medium">${row.time}</td>`;
            
            ['day1', 'day2', 'day3'].forEach(dayKey => {
                totalActivities++;
                const activityName = row[dayKey];
                const isRecorded = recordedList.includes(activityName);
                if (isRecorded) recordedCount++;
                const statusIcon = isRecorded ? '‚úÖ' : 'üÖæÔ∏è';
                const statusText = isRecorded ? '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
                reportTable += `<td class="border p-2"><div>${activityName}</div><div class="text-xs mt-1">${statusIcon} ${statusText}</div></td>`;
            });

            reportTable += '</tr>';
        });

        const printContent = `
            <div class="p-8">
                <div class="text-center mb-6 border-b pb-4">
                    <h1 class="text-2xl font-bold">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡∏π‡∏Å‡πÄ‡∏™‡∏∑‡∏≠</h1>
                    <h2 class="text-lg text-gray-700">${gradeInfo.title}</h2>
                    <p class="text-sm text-gray-500">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≤</p>
                </div>

                <div class="mb-6 p-4 bg-gray-100 rounded-lg text-center print-no-break">
                    <h3 class="font-semibold text-lg">‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</h3>
                    <p class="text-xl">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß <span class="font-bold text-green-600">${recordedCount}</span> / ${totalActivities} ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>
                </div>

                <div class="print-no-break">
                     <h3 class="font-semibold text-lg mb-2">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
                     <table class="w-full border-collapse text-sm">
                        <thead class="bg-gray-200">
                            <tr>
                                <th class="border p-2 text-left">‡πÄ‡∏ß‡∏•‡∏≤</th>
                                <th class="border p-2 text-left">‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å</th>
                                <th class="border p-2 text-left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á</th>
                                <th class="border p-2 text-left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${reportTable}
                        </tbody>
                     </table>
                </div>

                 <div class="mt-12 pt-4 text-sm text-gray-500 text-center">
                    <p>‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date().toLocaleString('th-TH')}</p>
                </div>
            </div>
        `;

        document.getElementById('printArea').innerHTML = printContent;
        window.print();
    }
    // END: MODIFIED AND NEW FUNCTIONS

    </script>
</body>
</html>
